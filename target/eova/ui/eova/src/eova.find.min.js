(function(d){var f=d.fn.eovatext.TextBox;FINDBOX="findbox";d.fn.eovafind=function(c){var a=[];this.each(function(){var b=d.data(this,FINDBOX);b?d.extend(b.options,c):(b=new e(this,c),b.render(),b.bindEvents(),b.init());d.data(this,FINDBOX,b);a.push(b)});return 1==a.length?a[0]:a};var e=d.fn.eovafind.FindBox=function(c,a){f.apply(this,arguments);this.defaults={width:180,btnTitle:"\u70b9\u51fb\u67e5\u627e\u5185\u5bb9",isReadonly:!0,onChange:function(a,c){}};this.options=d.extend({},this.options,this.defaults,d.getHtmlOptions(this),a);this.code=this.$dom.attr("code");this.$dom.removeAttr("code");this.field=this.$dom.attr("field");this.$dom.removeAttr("field")};d.extendPrototype(e,f);e.prototype.render=function(){var c=d("\x3cinput type\x3d'hidden' /\x3e").appendTo(this.$dom),a=d("\x3cinput type\x3d'text' /\x3e").appendTo(this.$dom),b=d("\x3ci class\x3d'ei'\x3e\x3c/i\x3e").appendTo(this.$dom);b.attr("title",this.options.btnTitle);this.name&&c.attr("name",this.name);this.value&&c.val(this.value);this.options.placeholder&&a.attr("placeholder",this.options.placeholder);this.options.required&&a.attr("required","required");this.options.disable&&this.$dom.mask();a.attr("readonly","readonly");a.css("cursor","pointer");a.attr("title",this.options.btnTitle);this.$valuebox=c;this.$textbox=a;this.$btn=b;this.setWidth(this.options.width)};e.prototype.init=function(){var c=this.$textbox;this.$valuebox.val()&&d.ajax({url:"/widget/findCnByEn/"+this.code+"-"+this.field+"-"+this.value,dataType:"json",success:function(a){var b=a.text_field,e=[];d.each(eval(a.data),function(a,c){e.push(c[b])});c.val(e.join(","))}})};e.prototype.bindEvents=function(){var c=this,a=this.options,b=this.$textbox,d=this.$dom;this.$textbox.bind("click",function(){var b=d.attr("url");b||(b=a.url);g(c,b)});this.$btn.bind("click",function(){b.trigger("click")})};e.prototype.getValue=function(){return this.$valuebox.val()};e.prototype.setValue=function(c){this.$valuebox.val(c)};e.prototype.getText=function(){return this.$textbox.val()};e.prototype.setText=function(c){this.$textbox.val(c)};var g=function(c,a){var b=window.sy.modalDialog({title:"\u8bf7\u9009\u62e9\u6570\u636e",url:a,buttons:[{id:"find_ok",text:"\u786e\u5b9a",handler:function(){b.find("iframe").get(0).contentWindow.selectData(b,c);window.focus()}}]},650,600)}})(jQuery);